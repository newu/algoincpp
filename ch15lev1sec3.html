<html><head><title>15.3. Patricia Tries</title><title>TeamUnknown</title><meta http-equiv="Content-Type" content="text/html;charset=utf-8" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/globalstyle.css" /><link href="includes/searchResults.css" rel="stylesheet" type="text/css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/style.css" /><link rel="STYLESHEET" type="text/css" href="portals/bvdep/xsltemplates/docsafari.css" /><body><table width="100%" border="0" cellspacing="0" cellpadding="0"><td class="docBookTitle"><a href="toc.html"><b>[ Team Unknown ]</b></a></td></table><td align="center"><a name="MainContent"></a><table width="95%"><tr><td align="left" class="v2"><!--Copyright (c) 2002 Safari Tech Books Online--><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="17051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch15lev1sec2.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch15lev1sec4.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><div id="section"><br /><table width="100%" border="0" cellspacing="0" cellpadding="0"><tr><td valign="top">C++ Programming Robert Sedgewick - Princeton University Addison Wesley Professional Algorithms in C++, Parts 1&ndash;4: Fundamentals, Data Structure, Sorting, Searching, Third Edition<a name="ch15lev1sec3"></a>
<h3 id="643999-952" class="docSection1Title">15.3. Patricia Tries</h3>
<p class="docText">Trie-based search as described in <a class="docLink" href="ch15lev1sec2.html#ch15lev1sec2">Section 15.2</a> has two inconvenient flaws. First, the one-way branching leads to the creation of extra nodes in the trie, which seem unnecessary. Second, there are two different types of nodes in the trie, which leads to complications (see <a class="docLink" href="ch15lev1sec2.html#ch15qa2q10">Exercises 15.20</a> and <a class="docLink" href="ch15lev1sec2.html#ch15qa2q11">15.21</a>). In 1968, Morrison discovered a way to avoid both of these problems, in a method that he named <span class="docEmphasis">patricia</span>(&quot;practical algorithm to retrieve information coded in alphanumeric&quot;). Morrison developed his algorithm in the context of string-indexing applications of the type that we shall consider in <a class="docLink" href="ch15lev1sec5.html#ch15lev1sec5">Section 15.5</a>, but <a name="iddle1733"></a><a name="iddle2585"></a>it is equally effective as a symbol-table implementation. Like DSTs, patricia tries allow search for <span class="docEmphasis">N</span> keys in a tree with just <span class="docEmphasis">N</span> nodes; like tries, they require only about <tt>lg</tt> <span class="docEmphasis">N</span> bit comparisons and one full key comparison per search, and they support other ADT operations. Moreover, these performance characteristics are independent of key length, and the data structure is suitable for variable-length keys.</p>
<p class="docText">Starting with the standard trie data structure, we avoid one-way branching via a simple device: we put into each node the index of the bit to be tested to decide which path to take out of that node. Thus, we jump directly to the bit where a significant decision is to be made, bypassing the bit comparisons at nodes where all the keys in the subtree have the same bit value. Moreover, we avoid external nodes via another simple device: we store data in internal nodes and replace links to external nodes with links that point back upwards to the correct internal node in the trie. These two changes allow us to represent tries with binary trees comprising nodes with a key and two links (and an additional field for the index), which we call <span class="docEmphasis">patricia tries</span>. With patricia tries, we store keys in nodes as with DSTs, and we traverse the tree according to the bits of the search key, but we do not use the keys in the nodes on the way down the tree to control the search; we merely store them there for possible later reference, when the bottom of the tree is reached.</p>
<p class="docText">As hinted in the previous paragraph, it is easier to follow the mechanics of the algorithm if we first take note that we can regard standard tries and patricia tries as different representations of the same abstract trie structure. For example, the tries in <a class="docLink" href="#ch15fig10">Figure 15.10</a> and at the top in <a class="docLink" href="#ch15fig11">Figure 15.11</a>, which illustrate search and insertion for patricia tries, represent the same abstract structure as do the tries in <a class="docLink" href="ch15lev1sec2.html#ch15fig06">Figure 15.6</a>. The search and insertion algorithms for patricia tries use, build, and maintain a concrete representation of the abstract trie data structure different from the search and insertion algorithms discussed in <a class="docLink" href="ch15lev1sec2.html#ch15lev1sec2">Section 15.2</a>, but the underlying trie abstraction is the same.</p>
<a name="ch15fig10"></a><p><center>
<h5 class="docFigureTitle">Figure 15.10. Patricia search</h5>
<h5></h5><h5></h5></center></p><p class="docText">In a successful search for <tt>R = 10010</tt> in this sample patricia trie (top), we move right (since bit 0 is <tt>1</tt>), then left (since bit 4 is <tt>0</tt>), which brings us to R (the only key in the tree that begins with <tt>1***0</tt>). On the way down the tree, we check only the key bits indicated in the numbers over the nodes (and ignore the keys in the nodes). When we first reach a link that points up the tree, we compare the search key against the key in the node pointed to by the up link, since that is the only key in the tree that could be equal to the search key.</p><h5></h5><p class="docText">In an unsuccessful search for <tt>I = 01001</tt>, we move left at the root (since bit 0 of the key is <tt>0</tt>), then take the right (up) link (since bit 1 is <tt>1</tt>) and find that <tt>H</tt> (the only key in the trie that begins with <tt>01</tt>) is not equal to <tt>I</tt>.</p>
<p class="docText">
<img border="0" alt="" id="118095012104" width="185" height="114" src="15fig10.gif" /></p>
<br />
<a name="ch15fig11"></a><p><center>
<h5 class="docFigureTitle">Figure 15.11. Patricia-trie insertion</h5>
<h5></h5><h5></h5></center></p><p class="docText">To insert <tt>I</tt> into the sample patricia trie in <a class="docLink" href="#ch15fig10">Figure 15.10</a>, we add a new node to check bit 4, since <tt>H = 01000</tt> and <tt>I = 01001</tt> differ in only that bit (top). On a subsequent search in the trie that comes to the new node, we want to check <tt>H</tt> (left link) if bit 4 of the search key is 0; if the bit is 1 (right link), the key to check is <tt>I</tt>.</p><h5></h5><p class="docText">To insert <tt>N = 01110</tt> (bottom), we add a new node in between <tt>H</tt> and <tt>I</tt> to check bit 2, since that bit distinguishes <tt>N</tt> from <tt>H</tt> and <tt>I</tt>.</p>
<p class="docText">
<img border="0" alt="" id="118095012104" width="300" height="286" src="15fig11.gif" /></p>
<br />
<p class="docText"><a class="docLink" href="#ch15ex09">Program 15.4</a> is an implementation of the patricia-trie search algorithm. The method differs from trie search in three ways: there are no explicit null links, we test the indicated bit in the key instead of the next bit, and we end with a search key comparison at the point where we follow a link up the tree. It is easy to test whether a link points up, because the bit indices in the nodes (by definition) increase as we travel down the tree. To search, we start at the root and proceed down the tree, using the bit index in each node to tell us which bit to examine in the search key&mdash;we go right if that bit is 1, left if it is 0. The keys in the nodes are not examined at all on the way down the tree. Eventually, an upward link is encountered: each upward link points to the unique key in the tree that has the bits that would cause a search to take that link. Thus, if the key at the node pointed to by the first upward link encountered is equal to the search key, then the search is successful; otherwise, it is unsuccessful.</p>
<a name="ch15ex09"></a><h5 id="title-IDAPSK4B" class="docExampleTitle">Program 15.4. Patricia-trie search</h5><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>
<p class="docText">The recursive function <tt>searchR</tt> returns the unique node that could contain the record with key <span class="docEmphasis">v</span>. It travels down the trie, using the bits of the tree to control the search, but tests only 1 bit per node encountered&mdash;the one indicated in the <tt>bit</tt> field. It terminates the search when it encounters an external link, one which points up the tree. The search function search calls <tt>searchR</tt>, then tests the key in that node to determine whether the search is a hit or a miss.</p>
<div class="docText"><pre> private:
   Item searchR(link h, Key v, int d)
     {
       if (h-&gt;bit &lt;= d) return h-&gt;item;
       if (digit(v, h-&gt;bit) == 0)
            return searchR(h-&gt;l, v, h-&gt;bit);
      else  return searchR(h-&gt;r, v, h-&gt;bit);
     }
 public:
   Item search(Key v)
     { Item t = searchR(head, v, -1);
       return (v == t.key()) ? t : nullItem;
     }</pre></div><br />
</td></tr></table></p>
<p class="docText"><a class="docLink" href="#ch15fig10">Figure 15.10</a> illustrates search in a patricia trie. For a miss due to the search taking a null link in a trie, the corresponding patricia trie search will take a course somewhat different from that of standard trie search, because the bits that correspond to one-way branching are not tested at all on the way down the trie. For a search ending at a leaf in a trie, the patricia-trie search ends up comparing against the same <a name="iddle1968"></a>key as the trie search, but without examining the bits corresponding to one-way branching in the trie.</p>
<p class="docText">The implementation of insertion for patricia tries mirrors the two cases that arise in insertion for tries, as illustrated in <a class="docLink" href="#ch15fig11">Figure 15.11</a>. As usual, we gain information on where a new key belongs from a search miss. For tries, the miss can occur either because of a null link or because of a key mismatch at a leaf. For patricia tries, we need to do more work to decide which type of insertion is needed, because we skipped the bits corresponding to one-way branching during the search. A patricia-trie search always ends with a key comparison, and this key carries the information that we need. We find the leftmost bit position where the search key and the key that terminated the search differ, then search through the trie again, comparing that bit position against the bit positions in the nodes on the search path. If we come to a node that specifies a bit position higher than the bit position that distinguishes the key sought and the key found, then we know that we skipped a bit in the patricia-trie search that would have led to a null link in the corresponding trie search, so we add a new node for testing that bit. If we never come to a node that specifies a bit position higher than the one that distinguishes the key sought and the key found, then the patricia-trie search corresponds to a trie search ending in a leaf, and we add a new node that distinguishes the search key from the key that terminated the search. We always add just one node, which references the leftmost bit that distinguishes the keys, where standard trie insertion might add multiple nodes with one-way branching before reaching that bit. That new node, besides providing the bit-discrimination that we need, will also be the node that we use to store the new item. <a class="docLink" href="#ch15fig12">Figure 15.12</a> shows the initial stages of the construction of a sample trie.</p>
<a name="ch15fig12"></a><p><center>
<h5 class="docFigureTitle">Figure 15.12. Patricia-trie construction</h5>
<h5></h5><h5></h5></center></p><p class="docText">This sequence depicts the result of inserting the keys <tt>A S E R C H</tt> into an initially empty patricia trie. <a class="docLink" href="#ch15fig11">Figure 15.11</a> depicts the result of inserting <tt>I</tt> and then <tt>N</tt> into the tree at the bottom.</p>
<p class="docText">
<img border="0" alt="" id="118095012104" width="175" height="503" src="15fig12.gif" /></p>
<br />
<p class="docText"><a class="docLink" href="#ch15ex10">Program 15.5</a> is an implementation of the patricia-trie&ndash;insertion algorithm. The code follows directly from the description in the previous paragraph, with the additional observation that we view links to nodes with bit indices that are not larger than the current bit index as links to external nodes. The insertion code merely tests this property of the links, but does not have to move keys or links around at all. The upward links in patricia tries seem mysterious at first, but the decisions about which links to use when each node is inserted are surprisingly straightforward. The end result is that using one node type rather than two simplifies the code substantially.</p>
<p class="docText"></p><a name="ch15ex10"></a><h5 id="title-IDACWK4B" class="docExampleTitle">Program 15.5. Patricia-trie insertion</h5><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>
<p class="docText">To insert a key into a patricia trie, we begin with a search. The function <tt>searchR</tt> from <a class="docLink" href="#ch15ex09">Program 15.4</a> gets us to a unique key in the tree that must be distinguished from the key to be inserted. We determine the leftmost bit position at which this key and the search key differ, then use the recursive function <tt>insertR</tt> to travel down the tree and to insert a new node containing v at that point.</p>
<p class="docText">In <tt>insertR</tt>, there are two cases, corresponding to the two cases illustrated in <a class="docLink" href="#ch15fig11">Figure 15.11</a>. The new node could replace an internal link (if the search key differs from the key found in a bit position that was skipped), or an external link (if the bit that distinguishes the search key from the found key was not needed to distinguish the found key from all the other keys in the trie).</p>
<div class="docText"><pre> private:
   link insertR(link h, Item x, int d, link p)
     { Key v = x.key();
       if ((h-&gt;bit &gt;= d) || (h-&gt;bit &lt;= p-&gt;bit))
         {
           link t = new node(x); t-&gt;bit = d;
           t-&gt;l = (digit(v, t-&gt;bit) ? h : t);
           t-&gt;r = (digit(v, t-&gt;bit) ? t : h);
           return t;
         }
       if (digit(v, h-&gt;bit) == 0)
            h-&gt;l = insertR(h-&gt;l, x, d, h);
       else  h-&gt;r = insertR(h-&gt;r, x, d, h);
       return h;
         }
     public:
       void insert(Item x)
         { Key v = x.key(); int i;
           Key w = searchR(head-&gt;l, v, -1).key();
           if (v == w) return;
           for (i = 0; digit(v, i) == digit(w, i); i++) ;
           head-&gt;l = insertR(head-&gt;l, x, i, head);
         }
       ST(int maxN)
         { head = new node(nullItem);
           head-&gt;l = head-&gt;r = head; }</pre></div><br />
</td></tr></table></p>
<p class="docText"></p><a name="ch15ex11"></a><h5 id="title-IDARXK4B" class="docExampleTitle">Program 15.6. Patricia-trie sort</h5><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>
<p class="docText">This recursive procedure shows the records in a patricia trie in order of their keys. We imagine the items to be in (virtual) external nodes, which we can identify by testing when the bit index on the current node is not larger than the bit index on its parent. Otherwise, this program is a standard inorder traversal.</p>
<div class="docText"><pre> private:
   void showR(link h, ostream&amp; os, int d)
     {
       if (h-&gt;bit &lt;= d) { h-&gt;item.show(os); return; }
       showR(h-&gt;l, os, h-&gt;bit);
       showR(h-&gt;r, os, h-&gt;bit);
    }
 public:
   void show(ostream&amp; os)
     { showR(head-&gt;l, os, -1); }</pre></div><br />
</td></tr></table></p>
<p class="docText">By construction, all external nodes below a node with bit index <tt>k</tt> begin with the same <tt>k</tt> bits (otherwise, we would have created a node with bit index less than <tt>k</tt> to distinguish two of them). Therefore, we can convert a patricia trie to a standard trie by creating the appropriate internal nodes between nodes where bits are skipped and by replacing links that point up the tree with links to external nodes (see <a class="docLink" href="#ch15qa3q16">Exercise 15.48</a>). However, <a class="docLink" href="ch15lev1sec2.html#ch15ex06">Property 15.2</a> does not quite hold for patricia tries, because the assignment of keys to internal nodes does depend on the order in which the keys are inserted. The structure of the internal nodes is independent of the key-insertion order, but external links and the placement of the key values are not.</p>
<p class="docText">An important consequence of the fact that a patricia trie represents an underlying standard trie structure is that we can use a recursive inorder traversal to visit the nodes in order, as demonstrated in the implementation given in <a class="docLink" href="#ch15ex11">Program 15.6</a> We visit just the external nodes, which we identify by testing for nonincreasing bit indices.</p>
<p class="docText">Patricia is the quintessential radix search method: it manages to identify the bits that distinguish the search keys and to build them into <a name="iddle2583"></a>a data structure (with no surplus nodes) that quickly leads from any search key to the only key in the data structure that could be equal to the search key. <a class="docLink" href="#ch15fig13">Figure 15.13</a> shows the patricia trie for the same keys used to build the trie of <a class="docLink" href="ch15lev1sec2.html#ch15fig09">Figure 15.9</a>&mdash;the patricia trie not only has 44 percent fewer nodes than the standard trie, but also is nearly perfectly balanced.</p>
<a name="ch15fig13"></a><p><center>
<h5 class="docFigureTitle">Figure 15.13. Patricia-trie example</h5>
<h5></h5><h5></h5></center></p><p class="docText">This patricia trie, built by insertion of about 200 random keys, is equivalent to the trie of <a class="docLink" href="ch15lev1sec2.html#ch15fig09">Figure 15.9</a> with one-way branching removed. The resulting tree is nearly perfectly balanced.</p>
<p class="docText">
<img border="0" alt="" id="118095012104" width="420" height="62" src="15fig13.gif" /></p>
<br />
<a name="ch15ex12"></a><h5 id="title-IDAH1K4B" class="docExampleTitle">Property 15.5. <span class="docEmphasis">Insertion or search for a random key in a patricia trie built from N random bitstrings requires about</span> <span class="docEmphRoman">lg</span><span class="docEmphasis">N bit comparisons on the average, and about</span> <span class="docEmphRoman">2lg</span> <span class="docEmphasis">N bit comparisons in the worst case. The number of bit comparisons is never more than the length of the key</span></h5><p><table cellspacing="0" width="90%" border="1" cellpadding="5"><tr><td>
<p class="docText">This fact is an immediate consequence of <a class="docLink" href="ch15lev1sec2.html#ch15ex07">Property 15.3</a>, since paths in patricia tries are no longer than paths in the corresponding trie. The precise average-case analysis of patricia is difficult; it turns out that patricia involves one fewer comparison, on the average, than does a standard trie (<span class="docEmphasis">see reference section</span>).</p>
</td></tr></table></p>
<p class="docText"><a class="docLink" href="#ch15table01">Table 15.1</a> gives empirical data supporting the conclusion that DSTs, standard binary tries, and patricia tries have comparable performance (and that they provide search times comparable to or shorter than the balanced-tree methods of <a class="docLink" href="ch13.html#ch13">Chapter 13</a>) when keys are integers, and certainly should be considered for symbol-table implementations even with keys that can be represented as short bitstrings, taking into account the various straightforward tradeoffs that we have noted.</p>
<a name="ch15table01"></a><p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><caption><h5 class="docTableTitle">Table 15.1. Empirical study of trie implementations</h5></caption><colgroup align="left" span="9"><col width="55"></col><col width="55"></col><col width="55"></col><col width="55"></col><col width="55"></col><col width="55"></col><col width="55"></col><col width="55"></col><col width="55"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top" colspan="9"><p class="docText">These relative timings for construction and search in symbol tables with random sequences of 32-bit integers confirm that digital methods are competitive with balanced-tree methods, even for keys that are random bits. Performance differences are more remarkable when keys are long and are not necessarily random (see <a class="docLink" href="#ch15table02">Table 15.2</a>), or when careful attention is paid to making the key-bit&ndash;access code efficient (see <a class="docLink" href="ch15lev1sec2.html#ch15qa2q12">Exercise 15.22</a>).</p></td></tr><tr><td class="docTableCell" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="center" valign="top" colspan="4"><p class="docText">construction</p></td><td class="bottomBorder" align="center" valign="top" colspan="4"><p class="docText">search hits</p></td></tr><tr><td class="bottomBorder" align="right" valign="top"><p class="docText"><span class="docEmphasis">N</span></p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">B</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">D</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">T</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">P</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">B</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">D</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">T</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">P</p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">1250</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">1</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">1</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">1</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">1</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">0</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">1</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">1</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">0</p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">2500</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">2</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">2</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">4</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">3</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">1</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">1</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">2</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">1</p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">5000</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">4</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">5</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">7</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">7</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">3</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">2</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">3</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">2</p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">12500</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">18</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">15</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">20</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">18</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">8</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">7</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">9</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">7</p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">25000</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">40</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">36</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">44</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">41</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">20</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">17</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">20</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">17</p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">50000</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">81</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">80</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">99</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">90</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">43</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">41</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">47</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">36</p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">100000</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">176</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">167</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">269</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">242</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">103</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">85</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">101</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">92</p></td></tr><tr><td class="bottomBorder" align="right" valign="top"><p class="docText">200000</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">411</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">360</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">544</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">448</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">228</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">179</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">211</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">182</p></td></tr><tr><td class="docTableCell" align="left" valign="top" colspan="9"><p class="docText"><span class="docEmphasis">Key</span>:</p>
<blockquote><p></p><p class="docList">B Red&ndash;black BST (<a class="docLink" href="ch12lev1sec5.html#ch12ex15">Programs 12.8</a> and <a class="docLink" href="ch13lev1sec4.html#ch13ex15">13.6</a>)</p></blockquote></td></tr></table></p><p></p><p class="docList">D DST (<a class="docLink" href="ch15lev1sec1.html#ch15ex01">Program 15.1</a>)</p><p></p><p class="docList">T Trie (<a class="docLink" href="ch15lev1sec2.html#ch15ex04">Programs 15.2</a> and <a class="docLink" href="ch15lev1sec2.html#ch15ex05">15.3</a>)</p><p></p><p class="docList">P Patricia trie (<a class="docLink" href="#ch15ex09">Programs 15.4</a> and <a class="docLink" href="#ch15ex10">15.5</a>)</p></td></tr></table><br />
<a name="ch15table02"></a><p><table cellspacing="0" frame="void" rules="none" cellpadding="5"><caption><h5 class="docTableTitle">Table 15.2. Empirical study of search with string keys</h5></caption><colgroup align="left" span="9"><col width="100"></col><col width="55"></col><col width="55"></col><col width="55"></col><col width="55"></col><col width="55"></col><col width="55"></col><col width="55"></col><col width="55"></col></colgroup><thead></thead><tr><td class="docTableCell" align="left" valign="top" colspan="9"><p class="docText">These relative timings for construction and search in symbol tables with string keys such as the library call numbers in <a class="docLink" href="ch15lev1sec4.html#ch15fig18">Figure 15.18</a> confirm that TSTs, although slightly more expensive to construct, provide the fastest search for search misses with string keys, primarily because the search does not require examination of all the characters in the key.</p></td></tr><tr><td class="docTableCell" align="left" valign="top">&nbsp;</td><td class="bottomBorder" align="center" valign="top" colspan="4"><p class="docText">construction</p></td><td class="bottomBorder" align="center" valign="top" colspan="4"><p class="docText">search misses</p></td></tr><tr><td class="bottomBorder" align="right" valign="top"><p class="docText"><span class="docEmphasis">N</span></p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">B</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">H</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">T</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">T<sup><a class="docLink" href="#ft_05">*</a></sup></p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">B</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">H</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">T</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">T<sup><a class="docLink" href="#ft_05">*</a></sup></p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">1250</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">4</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">4</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">5</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">5</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">2</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">2</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">2</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">1</p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">2500</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">8</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">7</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">10</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">9</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">5</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">5</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">3</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">2</p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">5000</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">19</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">16</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">21</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">20</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">10</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">8</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">6</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">4</p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">12500</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">48</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">48</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">54</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">97</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">29</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">27</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">15</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">14</p></td></tr><tr><td class="docTableCell" align="right" valign="top"><p class="docText">25000</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">118</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">99</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">188</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">156</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">67</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">59</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">36</p></td><td class="docTableCell" align="right" valign="top"><p class="docText">30</p></td></tr><tr><td class="bottomBorder" align="right" valign="top"><p class="docText">50000</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">230</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">191</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">333</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">255</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">137</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">113</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">70</p></td><td class="bottomBorder" align="right" valign="top"><p class="docText">65</p></td></tr><tr><td class="docTableCell" align="left" valign="top" colspan="9"><p class="docText"><span class="docEmphasis">Key</span>:</p>
<ul><li><p class="docList">B Standard BST (<a class="docLink" href="ch12lev1sec5.html#ch12ex15">Program 12.8</a>)</p></li><li><p class="docList">H Hashing with separate chaining (<span class="docEmphasis">M = N/5</span>) (<a class="docLink" href="ch14lev1sec2.html#ch14ex03">Program 14.3</a>)</p></li><li><p class="docList">T TST (<a class="docLink" href="ch15lev1sec4.html#ch15ex17">Program 15.8</a>)</p></li><li><p class="docList"><a name="ft_05"></a>T* TST with R<sup>2</sup>-way branch at root (<a class="docLink" href="ch15lev1sec4.html#ch15ex21">Program 15.11</a> and <a class="docLink" href="ch15lev1sec4.html#ch15ex22">15.12</a>)</p></li></ul></td></tr></table></p><br />
<p class="docText">Note that the search cost given in <a class="docLink" href="#ch15ex12">Property 15.5</a> does <span class="docEmphasis">not</span> grow with the key length. By contrast, the search cost in a standard trie typically does depend on the length of the keys&mdash;the first bit position that differs in two given keys could be arbitrarily far into the key. All the comparison-based search methods that we have considered also depend on the key length&mdash;if two keys differ in only their rightmost bit, then comparing them requires time proportional to their length.</p>
<p class="docText"><a name="iddle1586"></a>Furthermore, hashing methods <span class="docEmphasis">always</span> require time proportional to the key length for a search, to compute the hash function. But patricia immediately takes us to the bits that matter, and typically involves testing less than <tt>lg</tt> <span class="docEmphasis">N</span> of them. This effect makes patricia (or trie search with one-way branching removed) the search method of choice when the search keys are long.</p>
<p class="docText">For example, suppose that we have a computer that can efficiently access 8-bit bytes of data, and we have to search among millions of 1000-bit keys. Then patricia would require accessing only about 20 bytes of the search key for the search, plus one 125-byte equality comparison, whereas hashing would require accessing all 125 bytes of the search key to compute the hash function, plus a few equality comparisons, and comparison-based methods would require 20 to 30 full key comparisons. It is true that key comparisons, particularly in the early stages of a search, require only a few byte comparisons, but later stages typically involve many more bytes. We shall consider comparative performance of various methods for searching with lengthy keys again in <a class="docLink" href="ch15lev1sec5.html#ch15lev1sec5">Section 15.5</a>.</p>
<p class="docText">Indeed, there needs to be no limit at all on the length of search keys for patricia. Patricia is particularly effective in applications with variable-length keys that are potentially huge, as we shall see in <a class="docLink" href="ch15lev1sec5.html#ch15lev1sec5">Section 15.5</a>. With patricia, we generally can expect that the number of bit inspections required for a search among <span class="docEmphasis">N</span> records, even with huge keys, will be roughly proportional to <tt>lg</tt> <span class="docEmphasis">N</span>.</p>
<p class="docQandasetTitle">Exercises</p><p><table border="0" cellspacing="16" cellpadding="0"><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q1"></a><b></b></td><td><p class="docText"><span class="docEmphStrong">15.33</span> What happens when you use <a class="docLink" href="#ch15ex10">Program 15.5</a> to insert a record whose key is equal to some key already in the trie?</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q2"></a><b></b></td><td><p class="docText">
<img border="0" alt="" id="118095012104" width="8" height="9" src="triangle.jpg" />
<span class="docEmphStrong">15.34</span> Draw the patricia trie that results when you insert the keys <tt>E A S Y Q U T I O N</tt> in that order into an initially empty trie.</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q3"></a><b></b></td><td><p class="docText">
<img border="0" alt="" id="118095012104" width="8" height="9" src="triangle.jpg" />
<span class="docEmphStrong">15.35</span> Draw the patricia trie that results when you insert the keys <tt>01010011 00000111 00100001 01010001 11101100 00100001 10010101 01001010</tt> in that order into an initially empty trie.</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q4"></a><b></b></td><td><p class="docText">
<img border="0" alt="" id="118095012104" width="8" height="9" src="circle.jpg" />
<span class="docEmphStrong">15.36</span> Draw the patricia trie that results when you insert the keys <tt>01001010 10010101 00100001 11101100 01010001 00100001 00000111 01010011</tt> in that order into an initially empty trie.</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q5"></a><b></b></td><td><p class="docText"><span class="docEmphStrong">15.37</span> Run empirical studies to compare the height and internal path length of a patricia trie built by insertion of <span class="docEmphasis">N</span> random 32-bit keys into an initially empty trie with the same measures of a standard binary search tree and a red&ndash;black tree (<a class="docLink" href="ch13.html#ch13">Chapter 13</a>) built from the same keys, for <span class="docEmphasis"><tt>N</tt></span> <tt>= 10<sup>3</sup>, 10<sup>4</sup>, 10<sup>5</sup></tt>, and <tt>10<sup>6</sup></tt>(see <a class="docLink" href="ch15lev1sec1.html#ch15qa1q6">Exercises 15.6</a> and <a class="docLink" href="ch15lev1sec2.html#ch15qa2q4">15.14</a>).</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q6"></a><b></b></td><td><p class="docText"><span class="docEmphStrong">15.38</span> Give a full characterization of the worst-case internal path length of a patricia trie with <span class="docEmphasis">N</span> distinct <span class="docEmphasis">w</span>-bit keys.</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q7"></a><b></b></td><td><p class="docText">
<img border="0" alt="" id="118095012104" width="8" height="9" src="triangle.jpg" />
<span class="docEmphStrong">15.39</span> Implement the <span class="docEmphasis">select</span> operation for a patricia-based symbol table.</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q8"></a><b></b></td><td><p class="docText">
<img border="0" alt="" id="118095012104" width="8" height="8" src="blackcircle.jpg" />
<span class="docEmphStrong">15.40</span> Implement the <span class="docEmphasis">remove</span> operation for a patricia-based symbol table.</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q9"></a><b></b></td><td><p class="docText">
<img border="0" alt="" id="118095012104" width="8" height="8" src="blackcircle.jpg" />
<span class="docEmphStrong">15.41</span> Implement the <span class="docEmphasis">join</span> operation for patricia-based symbol tables.</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q10"></a><b></b></td><td><p class="docText">
<img border="0" alt="" id="118095012104" width="8" height="9" src="circle.jpg" />
<span class="docEmphStrong">15.42</span> Write a program that prints out all keys in a patricia trie that have the same initial <tt>t</tt> bits as a given search key.</p></td></tr><tr><td></td><td></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q11"></a><b></b></td><td><p class="docText"><a name="iddle1734"></a><span class="docEmphStrong">15.43</span> Modify standard trie search and insertion (<a class="docLink" href="ch15lev1sec2.html#ch15ex04">Programs 15.2</a> and <a class="docLink" href="ch15lev1sec2.html#ch15ex05">15.3</a>) to eliminate one-way branching in the same manner as for patricia tries. If you have done <a class="docLink" href="ch15lev1sec2.html#ch15qa2q10">Exercise 15.20</a>, start with that program instead.</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q12"></a><b></b></td><td><p class="docText"><span class="docEmphStrong">15.44</span> Modify patricia search and insertion (<a class="docLink" href="#ch15ex09">Programs 15.4</a> and <a class="docLink" href="#ch15ex10">15.5</a>) to maintain a table of 2<span class="docEmphasis"><sup>r</sup></span> tries, as described in <a class="docLink" href="ch15lev1sec2.html#ch15qa2q13">Exercise 15.23</a>.</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q13"></a><b></b></td><td><p class="docText"><span class="docEmphStrong">15.45</span> Show that each key in a patricia trie is on its own search path, and is therefore encountered on the way down the tree during a <span class="docEmphasis">search</span> operation as well as at the end.</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q14"></a><b></b></td><td><p class="docText"><span class="docEmphStrong">15.46</span> Modify patricia search (<a class="docLink" href="#ch15ex09">Programs 15.4</a>) to compare keys on the way down the tree to improve search-hit performance. Run empirical studies to evaluate the effectiveness of this change (see <a class="docLink" href="#ch15qa3q13">Exercise 15.45</a>).</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q15"></a><b></b></td><td><p class="docText"><span class="docEmphStrong">15.47</span> Use a patricia trie to build a data structure that can support an existence table ADT for <span class="docEmphasis">w</span>-bit integers (see <a class="docLink" href="ch15lev1sec2.html#ch15qa2q22">Exercise 15.32</a>).</p></td></tr><tr valign="top"><td align="right" class="docText" width="50"><a name="ch15qa3q16"></a><b></b></td><td><p class="docText">
<img border="0" alt="" id="118095012104" width="8" height="8" src="blackcircle.jpg" />
<span class="docEmphStrong">15.48</span> Write programs that convert a patricia trie to a standard trie on the same keys, and vice versa.</p></td></tr></table></p>
<ul></ul></div></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="middle" class="v2" height="5"><img src="pixel.gif" width="1" height="5" alt="" border="0" /></td></tr><tr><td valign="middle" class="v2"><table cellpadding="0" cellspacing="0" border="0" width="100%"><tr><td align="left"><span style="white-space:nowrap">&nbsp;</span>
                  &nbsp;
                  <span style="white-space:nowrap"> &nbsp;&nbsp;</span>
            &nbsp;<span style="white-space:nowrap">&nbsp;</span></td></tr></table></td><td></td><td valign="middle" class="v2" align="right"><a href="17051538.html"><img src="btn_next_.gif" width="1" height="1" alt="Next" border="0" /></a> 
          &nbsp;
          <span style="white-space:nowrap"><a target="_self" href="ch15lev1sec2.html" title="Previous section"><img border="0" align="absmiddle" src="btn_prev.gif" alt="Previous section" id="btn_prev" /></a></span>
				
				&nbsp;
				
				<span style="white-space:nowrap"><a target="_self" href="ch15lev1sec4.html" title="Next section"><img border="0" align="absmiddle" src="btn_next.gif" alt="Next section" id="btn_next" /></a></span></td></tr></table><table width="100%" border="0" cellspacing="0" cellpadding="2"><tr><td valign="top" align="right"><span style="white-space:nowrap"><a target="_self" href="#toppage" title="Top"></a></span></td></tr></table><!--IP User 2--></td></body></head></html>